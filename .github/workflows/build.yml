name: Build, test and publish

on:
  push:
    branches: [ "john/testga" ]
    tags: [ '*' ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    name: Build code
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: 0
    - name: Talk to Octopus
      env:
        OCTOPUS_CLI_SERVER: ${{ secrets.OCTOPUS_URL }}
        OCTOPUS_CLI_API_KEY: ${{ secrets.INTEGRATIONS_API_KEY }}
      run: |
        echo "event.push.after = ${{ github.event.after }}"
        echo "event.pull_request.head.sha = ${{ github.event.head.sha }}"
        echo "head_ref = ${{ github.head_ref }}"
        echo "github.ref = ${{ github.ref }}"
      